<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CS 143: Introduction to Databases</title>
  <link rel="stylesheet" href="https://unpkg.com/@antonz/codapi@0.20.0/dist/snippet.css">
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <style>
    body { max-width: 48em; margin: 2em auto; padding: 0 1em; font-family: system-ui, sans-serif; line-height: 1.6; }
    pre { background: #f5f5f5; padding: 1em; overflow-x: auto; border-radius: 4px; }
    code { font-size: 0.95em; }
    table { border-collapse: collapse; border-spacing: 0; margin: 1em 0; }
    th, td { border: 1px solid #999; padding: 0.3em 0.8em; }
    codapi-output { line-height: 1.3; }
    codapi-snippet + .sourceCode { margin-top: 0.5em; }
    .sourceCode { margin-top: 0; margin-bottom: 0; }
  </style>
</head>
<body>
<script id="setup-basic" type="text/plain">
CREATE TABLE t (x int, y int);
INSERT INTO t VALUES (1, 5), (2, 4), (3, 3), (4, 2), (5, 1);
##CODE##
</script>
<script id="setup-agg" type="text/plain">
CREATE TABLE t (x int, y int);
INSERT INTO t VALUES (1, 5), (2, 4), (3, 3), (1, 2), (2, 1);
##CODE##
</script>
<script id="setup-pets" type="text/plain">
CREATE TABLE t (name text, toy text);
INSERT INTO t VALUES ('kira', 'üõçÔ∏è'), ('kira', 'üçº'), ('casa', 'üçº'), ('casa', 'üßª');
CREATE TABLE f (name text, food text);
INSERT INTO f VALUES ('kira', 'üêü'), ('kira', 'üçó'), ('casa', 'ü•¨'), ('casa', 'üçó');
##CODE##
</script>
<script id="setup-multi-agg" type="text/plain">
CREATE TABLE t (x int, y int, z int, w int);
INSERT INTO t VALUES (1, 1, 1, 5), (1, 1, 2, 4), (1, 2, 3, 3), (2, 3, 1, 2), (2, 3, 2, 1);
##CODE##
</script>
<h1>CS 143: Introduction to Databases</h1>
<nav><ul>
<li><a href="#why-cs-143" id="toc-why-cs-143">Why CS 143?</a></li>
<li><a href="#trying-things-out" id="toc-trying-things-out">Trying
things out</a></li>
<li><a href="#basic-sql" id="toc-basic-sql">Basic SQL</a></li>
<li><a href="#aggregates" id="toc-aggregates">Aggregates</a></li>
<li><a href="#relational-algebra" id="toc-relational-algebra">Relational
algebra</a></li>
<li><a href="#more-tables" id="toc-more-tables">More tables</a></li>
</ul></nav>
<h2 id="why-cs-143">Why CS 143?</h2>
<p>What‚Äôs the <a href="https://spectrum.ieee.org/the-rise-of-sql">most
popular programming language</a>?</p>
<p>How many databases are out there? (<a
href="https://sqlite.org/mostdeployed.html">1 trillion sqlite
DB</a>)</p>
<p>How old is the oldest DB? (<a
href="https://en.wikipedia.org/wiki/Kish_tablet">~3500 BC</a>, 5k years
old)</p>
<p>DB‚Äôs fun:</p>
<ul>
<li>Rite of passage of a systems hacker: write a compiler, write an OS,
write a DB</li>
<li>Beautiful <a href="http://webdam.inria.fr/Alice/">algorithms &amp;
theory</a></li>
</ul>
<h2 id="trying-things-out">Trying things out</h2>
<p><a href="https://sqlime.org">SQL playground</a></p>
<p>You might also have <code>sqlite</code> already installed on your
computer.</p>
<p>If running in terminal, remember to add semicolon <code>;</code> at
the end of each query.</p>
<p>First, <code>CREATE TABLE t (x int, y int)</code></p>
<p>Add data by
<code>INSERT INTO t VALUES (1, 5), (2, 4), (3, 3), (4, 2), (5, 1)</code></p>
<p>Check with <code>SELECT * FROM t</code> (<code>*</code> = all the
columns)</p>
<p>To remove rows, <code>DELETE FROM t WHERE x = 1 AND y = 5</code> (how
do you delete all rows?)</p>
<p>To remove table, <code>DROP TABLE t</code></p>
<h2 id="basic-sql">Basic SQL</h2>
<p>What do the following queries return given input?</p>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> x <span class="op">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb2"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x, y</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> y <span class="op">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb3"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> y <span class="op">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb4"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x<span class="op">+</span><span class="dv">1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> y <span class="op">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb5"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x<span class="op">+</span>y</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> y <span class="op">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb6"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x<span class="op">+</span>y</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> <span class="kw">NOT</span> y <span class="op">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb7"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x<span class="op">+</span>y</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> y <span class="op">&lt;</span> <span class="dv">3</span> <span class="kw">AND</span> x <span class="op">&gt;</span> <span class="dv">1</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb8"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> x<span class="op">+</span>y</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> y <span class="op">&lt;</span> <span class="dv">3</span> <span class="kw">OR</span> x <span class="op">&gt;</span> <span class="dv">1</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<p>General form:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> e(x, y)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> <span class="kw">table</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> cond(x, y)</span></code></pre></div>
<p>Meaning:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x, y) <span class="kw">in</span> table:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> cond(x, y):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e(x, y))</span></code></pre></div>
<h2 id="aggregates">Aggregates</h2>
<div class="sourceCode" id="cb11"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">SUM</span>(x) <span class="kw">FROM</span> t</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb12"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">MIN</span>(x) <span class="kw">FROM</span> t</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb13"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">MAX</span>(x) <span class="kw">FROM</span> t</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb14"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">AVG</span>(x) <span class="kw">FROM</span> t</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<div class="sourceCode" id="cb15"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">COUNT</span>(x) <span class="kw">FROM</span> t</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-basic"></codapi-snippet>
<p>Aggregate by groups:</p>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">..</span>.</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> t</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> x</span></code></pre></div>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>?</td>
</tr>
<tr>
<td>?</td>
<td>?</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>?</td>
</tr>
<tr>
<td>?</td>
<td>?</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>?</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> x, <span class="fu">SUM</span>(y)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> t</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> x</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-agg"></codapi-snippet>
<p><code>GROUP BY</code> variable (<code>x</code>) <strong>must</strong>
be <code>SELECT</code>ed, <code>AGG</code> function applied per
group.</p>
<p>Multiple group-by &amp; aggregate variables</p>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
<th>z</th>
<th>w</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> x, y, <span class="fu">MIN</span>(z), <span class="fu">MAX</span>(w)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> t</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> x, y</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-multi-agg"></codapi-snippet>
<p>Current general form:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>:   <span class="kw">SELECT</span> x, AGG(y)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>:     <span class="kw">FROM</span> t</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>:    <span class="kw">WHERE</span> cond(x, y)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>: <span class="kw">GROUP</span> <span class="kw">BY</span> x</span></code></pre></div>
<ol type="1">
<li>Where‚Äôs the data <code>FROM</code>?</li>
<li>Check conditions</li>
<li>Group rows</li>
<li>Run aggregate &amp; return</li>
</ol>
<h2 id="relational-algebra">Relational algebra</h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th>Name</th>
<th>Notation</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>selection</td>
<td><span class="math inline">\(\sigma_p(t)\)</span></td>
<td>filter by condition <span class="math inline">\(p\)</span></td>
</tr>
<tr>
<td>projection</td>
<td><span class="math inline">\(\pi_{e(x, y)}(t)\)</span></td>
<td>map an expression <span class="math inline">\(e\)</span> over <span
class="math inline">\(x, y\)</span></td>
</tr>
<tr>
<td>aggregation</td>
<td><span class="math inline">\(\gamma_{x, F(y)}(t)\)</span></td>
<td>group by <span class="math inline">\(x\)</span>, aggregate over
<span class="math inline">\(y\)</span> using <span
class="math inline">\(F\)</span></td>
</tr>
</tbody>
</table>
<p>Can you write out SQL query for each operation?</p>
<h2 id="more-tables">More tables</h2>
<p>Meet my pets:</p>
<table>
<thead>
<tr>
<th>name</th>
<th>toy</th>
</tr>
</thead>
<tbody>
<tr>
<td>kira</td>
<td>üõçÔ∏è</td>
</tr>
<tr>
<td>kira</td>
<td>üçº</td>
</tr>
<tr>
<td>casa</td>
<td>üçº</td>
</tr>
<tr>
<td>casa</td>
<td>üßª</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>name</th>
<th>food</th>
</tr>
</thead>
<tbody>
<tr>
<td>kira</td>
<td>üêü</td>
</tr>
<tr>
<td>kira</td>
<td>üçó</td>
</tr>
<tr>
<td>casa</td>
<td>ü•¨</td>
</tr>
<tr>
<td>casa</td>
<td>üçó</td>
</tr>
</tbody>
</table>
<p>What do these queries return?</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.name</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t, f</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> t.name <span class="op">=</span> f.name</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> t.toy <span class="op">=</span> <span class="st">&#39;üõçÔ∏è&#39;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> f.food <span class="op">=</span> <span class="st">&#39;üêü&#39;</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-pets"></codapi-snippet>
<div class="sourceCode" id="cb21"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.name</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t, f</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> t.name <span class="op">=</span> f.name</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> t.toy <span class="op">=</span> <span class="st">&#39;üõçÔ∏è&#39;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> f.food <span class="op">=</span> <span class="st">&#39;üçó&#39;</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-pets"></codapi-snippet>
<div class="sourceCode" id="cb22"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.name</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t, f</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> t.name <span class="op">=</span> f.name</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> t.toy <span class="op">=</span> <span class="st">&#39;üçº&#39;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> f.food <span class="op">=</span> <span class="st">&#39;üçó&#39;</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-pets"></codapi-snippet>
<div class="sourceCode" id="cb23"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.name</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t, f</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> t.name <span class="op">=</span> f.name</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> t.toy <span class="op">=</span> <span class="st">&#39;üõçÔ∏è&#39;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> f.food <span class="op">=</span> <span class="st">&#39;ü•¨&#39;</span></span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-pets"></codapi-snippet>
<p>General form for <strong>join</strong>ing tables:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">..</span>.</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> r, s</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> cond</span></code></pre></div>
<p>Meaning:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x1, x2, ... <span class="kw">in</span> r:</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> y1, y2, ... <span class="kw">in</span> s:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cond(x1, x2, ..., y1, y2, ...):</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> ...</span></code></pre></div>
<p>Try all possible pairings of a row from <code>r</code> and a row from
<code>s</code>. I.e., first compute the <em>Cartesian product</em> of
<code>r</code> and <code>s</code> (how many rows does the following
query return?):</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t, f</span></code></pre></div>
<codapi-snippet sandbox="sqlite" editor="basic" template="#setup-pets"></codapi-snippet>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t_row <span class="kw">in</span> t:</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> f_row <span class="kw">in</span> f:</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> t_row <span class="op">++</span> f_row</span></code></pre></div>
<p>Then evaluate rest of query using result.</p>
<p>In relational algebra: <span class="math inline">\(\sigma_p(t \times
f)\)</span>, or <span class="math inline">\(t \bowtie_p f\)</span> (the
<strong>join</strong>).</p>
<p>Current general form:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.</span>   <span class="kw">SELECT</span> R.x, <span class="fu">AVG</span>(T.z)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>     <span class="kw">FROM</span> R, S, T</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>    <span class="kw">WHERE</span> R.x <span class="op">=</span> S.x <span class="kw">AND</span> S.y <span class="op">=</span> T.y</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span> <span class="kw">GROUP</span> <span class="kw">BY</span> R.x</span></code></pre></div>
<p><img src="assets/ra.svg" alt="Relational Algebra for query general form" width="30%"></p>
<script src="https://unpkg.com/@antonz/codapi@0.20.0/dist/snippet.js"></script>
</body>
</html>
